= Zemax OpticStudio

== Purpose
* Validate Optical Performance of Optical Ground Station (OGS) & Payload
* Create simulations representing optical layouts
* Generate tolerancing data accounting for mechanical & thermal effects on optical misalignment

== Overview
Ansys Zemax OpticStudio (Zemax) is an optical simulation software used as a preliminary validation analysis tool for the Optical Ground Station (OGS) & Payload.  
Zemax, combined with its Python ZOS-API for automated ray-tracing, more efficiently provides data on the geometric misalignments within the optical design, which also helps achieve a more precise understanding of how certain hypothesized physical phenomena are propagating through the optical system.  

Some examples of acquired Zemax applications include:  
* Testing slight misalignments from lens vibrations  
* Thermal expansion of the CubeSat’s plating  
* Beam polarization conversion efficiency  
* Offset trajectories caused by the uplink beacon’s angular misalignment  

This data is used to obtain thresholds for the PULSE-A laser-communications optical performance, which not only determines which products are most effective, but also how the sub-assembly designs should be refined to satisfy these thresholds.

== Relevant Zemax Tools
* Model components relevant to the Optical Payload: sources (beams), lenses, mirrors, filters
* Jones Matrices – analyzing polarization propagation through system (further research needed)
* Sequential-Mode Analysis – linear beam paths, comprehensive beam-profile analysis, polarization data
* Nonsequential-Mode Analysis – optimal for complex beam paths: beam-splitting, multiple sources, scattering, stray light
* CubeSat’s Optical Payload Design best-tailored to nonsequential modeling: 2 sources to analyze (OGS Uplink Beacon + Payload Downlink Transmission)
* Coating Data Files – customized transmittance/reflectance for nonsequential ray analysis
* Ray-tracing: detector data analysis (e.g., QPD)  
* ZOS-API + Python – automation without GUI; tolerancing data across various parameters
* Well-documented public resources:  
  **Zemax Knowledge Base** – main hub for tutorials  
  **Zemax Community Forum** – Q&A for specific issues  
* Many test examples included (e.g., ZOS-API connection examples, Gaussian sources modeling)

== Zemax Simulation Procedure
. Identify theoretical concerns with the optical system (e.g., vibration, thermal, body-pointing, etc.)
. Research Zemax’s available tools for analyzing the problem (e.g., ray-tracing, coating, irradiance maps, sequential vs. non-sequential modes, ZOS-API, etc.)
. Identify available data types that Zemax can output (e.g., power, centroid, irradiance, etc.)
. Determine characterization of optical performance (data on QPD/detectors)
. Develop algorithm for ray-tracing & tweaking parameters (ZOS-API Python)
. Collect relevant data & analyze tolerancing results

== Simulation Results
Accurate, non-trivial model of Payload Optical Layout.  
Capable of non-sequential 3D Layout:  

*Fig. 1: Current Payload Optical Layout*  
Blue beams = OGS Uplink Beacon (1064nm)  
Green beams = Payload Downlink Transmission (1550nm)  

The transmission assembly encodes and modulates (at 1–10 MHz) the data into a circularly-polarized, amplified beam for the OGS to receive and decode. The transmission beam follows the same optical path as the uplink beacon, requiring a dichroic beam-splitter to multiplex the two signals.

=== Use of Irradiance Maps
*Fig. 2: Irradiance Map of OGS-Beacon Power Distribution on QPD Detector*  
*Fig. 3: Near-Center Gaussian QPD Irradiance Profile Plot*  

Note: gaps between the Gaussian distribution represent dead-zones of the QPD (between each quadrant). Darker circumference & halo hypothesized to be caused by lens spherical aberrations.

The Payload uses a 2x2 QPD with 1mm active diameter. Size constraints require extremely precise pointing & focusing. Slight misalignments result in non-uniform voltage signals.

=== ZOS-API in Python
Automates interaction with Zemax UI via namespaces (OOP).  
Iterative ray-tracing enables tolerancing over multiple parameter values for one/more optical components.

== FSM Mirror Preliminary Requirements Determination
The FSM corrects uplink beacon misalignments caused by body-pointing, thermal drift, or vibrations. For angular errors up to 1.00°, the FSM adjusts the optical path to center the beam on the QPD. A closed-loop control uses the QPD signal to compute the FSM mirror tilt via voltage-transfer function.

*Requirements:*
* **Mechanical Angle (deg.)** ≥ ~4.1° — overcorrection margin for 1.00° body-pointing error.
* **Active Diameter (mm)** ≥ 5.00 mm — prevent vignetting along FSM edges.

== Preliminary Validation of Thermal Model: Plate Expansion
Assuming uniform expansion of CubeSat aluminum plating.  
Misalignments expected due to expansion.  

Note: Power threshold is more sensitive than centroid — power decays exponentially faster with expansion.

== Preliminary Validation of Back-Reflected Light
Optical components can reflect light backward.  
Minimum Relative Ray Intensity (MRRI) defines smallest back-reflected bundle considered in ray-trace.  
Centroid changes are negligible; small power spikes observed (hypothesized from DS filter stack).

== Understanding Power Losses Through Optical System
Tables of total & relative losses for OGS uplink beacon and payload transmission calculated.  
Examples:  
* Kepl. Telescope Lenses  
* FSM Mirror  
* Dichroic  
* Bandpass Filter  
* QPD Focus Lens

== Impact
* Develop preliminary prototype for entire payload optical layout
* Determine relevant FSM requirements
* Requirement for ADCS alignment
* Preliminary validation for thermal & back-reflection tolerances

== Next Steps
* Develop model in sequential mode (more detailed beam & polarization data)
* Perform vibrational testing
* Observe polarization data through system
* Test mirror slew-rate/FSM-QPD feedback loop via ZOS-API Python
* Gather body-pointing misalignment vs. FSM tilt vs. QPD power distribution data for voltage-transfer function
